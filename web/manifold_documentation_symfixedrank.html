<!DOCTYPE html>
<html lang="en">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>Manopt, symmetric fixed-rank manifold</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link href="favicon.ico" rel="icon" type="image/x-icon">
    <!-- Le styles -->
    <link href="bootstrap/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
body {
	padding-top: 80px;
	padding-bottom: 40px;
}
thead {
	font-weight: bold;
}
</style> <link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script> <![endif]-->
    <link href="bootstrap/css/prettify.css" type="text/css" rel="stylesheet">
    <link href="bootstrap/css/lang-matlab.css" type="text/css" rel="stylesheet">
  </head>
  <body onload="prettyPrint()">
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner"> <a class="btn btn-navbar"><span
            class="icon-bar"></span> <span class="icon-bar"></span> <span
            class="icon-bar"></span> </a>
        <div class="container"> <a class="brand" href="index.html">Manopt</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li><a href="index.html"><i class="icon-home"></i> Home</a></li>
              <li><a href="tutorial.html"><i class="icon-road"></i> Tutorial</a></li>
              <li><a href="downloads.html"><i class="icon-download-alt"></i> Downloads</a></li>
            <li><a href="forum.html"><i class="icon-edit"></i> Forum</a></li>
            <li><a href="about.html"><i class="icon-user"></i> About</a></li>
            <li><a href="#contactmodal"><i class="icon-envelope"></i> Contact</a></li>
          </ul>
        </div>
        <!--/.nav-collapse --> </div>
    </div>
  </div>
  <!-- Contact modal Begin -->
  <div id="contactmodal" class="modal hide fade" tabindex="-1">
    <div class="modal-header"> <button type="button" class="close">&#215;</button>
      <h3 id="myModalLabel">To contact us</h3>
    </div>
    <div class="modal-body">
      <p>To discuss code, it is best to use the <a href="forum.html">forum</a>.</p>
      <p>For things not suitable for the forum, e-mail us at <a href="mailto:manopttoolbox@gmail.com">manopttoolbox@gmail.com</a>.</p>
      <p>We are happy to receive feedback and bug reports or requests for more features, to discuss the toolbox in general as well as its documentation and to help you use it.</p>
      <p>We would also love to know how you use the toolbox, and if you built nice manifold factories, solvers or tools that could benefit others.</p>
    </div>
    <div class="modal-footer"> <button class="btn">Close</button> </div>
  </div>
  <!-- Contact modal End -->
  <div class="container">
    <div class="row">
      <div class="span12">
        <!--Body content-->
        <section id="geometry">
          <div class="page-header">
            <h1>A Riemannian quotient geometry for the set of fixed-rank symmetric positive semidefinite matrices</h1>
          </div>
          <p>The set $S_+(n, k)$ of rank-$k$ symmetric positive semidefinite matrices $X$ of size $n\times n$ is parametrized as $X = YY^T$ where $Y \in \mathbb{R}^{n\times k}_*$ is a full column rank matrix of size $n\times k$. Notice that for all orthogonal matrices $O$ of size $k$, the transformation $Y \rightarrow YO$ leaves $X$ unchanged. As a result, we may consider all matrices of the form $YO$ as being <em>equivalent</em> for our purpose. Quotienting this equivalence relation out results in a quotient space, $\mathbb{R}^{n \times k}_* / {\rm O}(k)$, with ${\rm O}(k)$ the group of orthogonal matrices. A point on the quotient space is (conceptually) an equivalence class $[Y] = \{YO : O \in {\rm O}(k)\}$. Numerically, we represent that equivalence class with (any) matrix $Y$ in $[Y]$.</p>
          <p>A function $\phi : S_+(n,k) \to \mathbb{R}: X \mapsto \phi(X) $ induces a function $f: \mathbb{R}^{n \times k}_* \rightarrow \mathbb{R}: Y \mapsto f(Y)$ defined as $f(Y) = \phi(YY^T)$. Of course, $f$ has the appropriate invariance $f(Y) = f(YO)$ for all orthogonal $O$. Thus, $f$ is defined on the total space $\mathbb{R}^{n\times k}_*$ and descends as a well-defined function on the quotient space $\mathbb{R}^{n \times k}_* / {\rm O}(k)$. Endowing the total space with the usual Riemannian structure of a Euclidean space (the inner product $\langle H_1, H_2 \rangle = \operatorname{trace}(H_1^T H_2)$), a Riemannian structure for the quotient space follows.</p>
          <p>See the paper [JBAS10] referenced below for details on this geometry, and [AMS08] for general background.</p>
          <p> </p>
        <p>Factory call: <code>M = symfixedrankYYfactory(n, k)</code>. </p>
        <table style="width: 100%;" class="table table-striped table-bordered">
          <thead>
            <tr>
              <td>Name </td>
            <td>Formula </td>
          <td>Numerical representation</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Set</td>
          <td>$S_+(n,k) = \{X \in \mathbb{R}^{n\times n} : X=X^T\succeq 0, {\rm rank}(X) = k\} \\ = \{ YY^T: Y \in \mathbb{R}^{n\times k}, {\rm rank}(Y) = k\}$</td>
          <td>$X$ is represented by means of $Y$ as a matrix <code>Y</code> of size $n\times k$.</td>
        </tr>
        <tr>
          <td>Vertical space at $Y$</td>
          <td>$\{ Y\Omega : \Omega \in \mathbb{R}^{k\times k}, \Omega + \Omega^T = 0 \}$</td>
          <td>A vertical vector $U$ at $Y$ is represented as a matrix <code>U</code> of size $n\times k$: it is tangent to the equivalence classes.</td>
        </tr>
        <tr>
          <td>Horizontal space at $Y$</td>
          <td>$\{ U \in \mathbb{R}^{n\times k}: U^T Y = Y^T U \}$</td>
          <td>A horizontal vector $U$ at $Y$ is represented as a matrix <code>U</code> of size $n\times k$: it is orthogonal to all vertical vectors.</td>
        </tr>
        <tr>
          <td>Ambient space</td>
          <td>$\mathbb{R}^{n\times k}$</td>
          <td>Points and vectors in the ambient space are, naturally, represented as matrices of size $n\times k$.</td>
        </tr>
      </tbody>
    </table>
  </section>
  <section id="toolset">
    <div class="page-header">
      <h1>Toolset</h1>
    </div>
    <p>The following table shows some of the nontrivial available functions in the structure <code>M</code>. The <a
        href="tutorial.html#manifolds">tutorial page</a> gives more details about the functionality implemented by each function.</p>
    <table style="width: 100%;" class="table table-striped table-bordered">
      <thead>
        <tr>
          <td>Name </td>
        <td>Field usage </td>
      <td>Formula </td>
  </tr>
</thead>
<tbody>
  <tr>
    <td>Dimension </td>
  <td><code>M.dim() </code></td>
  <td>$\operatorname{dim}\mathcal{M} = kn - k(k-1)/2$ </td>
</tr>
<tr>
  <td>Metric </td>
<td><code>M.inner(Y, U, V) </code></td>
<td>$\langle U, V\rangle_Y = \operatorname{trace}(U^T V)$ </td>
</tr>
<tr>
  <td>Norm </td>
<td><code>M.norm(Y, U) </code></td>
<td>$\|U\|_Y = \sqrt{\langle U, U \rangle_Y}$</td>
</tr>
<tr>
  <td>Horizontal space projector </td>
<td><code>M.proj(Y, H) </code></td>
<td>$P_Y(H) = H - Y\Omega$, where <code>H</code> represents a vector in the ambient space. $\Omega$ is a skew-symmetric matrix obtained as the unique solution to the <a
    href="http://en.wikipedia.org/wiki/Sylvester_equation">Sylvester equation</a> $\Omega (Y^T Y) + (Y^T Y)\Omega = Y^T H - H^T Y $ </td>
</tr>
<tr>
  <td>Euclidean to Riemannian gradient</td>
  <td><nobr><code>M.egrad2rgrad(Y, egrad)</code></nobr></td>
  <td>$\operatorname{grad} f(Y) = \nabla f(Y)$, where <code>egrad</code> represents the Euclidean gradient $\nabla f(Y)$, which is a vector in the ambient space. There is indeed nothing to do, since the Euclidean gradient of $f$ is already a horizontal vector thanks to the fact that $f(Y) = f(YO)$ for all orthogonal $O$. </td>
</tr>
<tr>
  <td>Euclidean to Riemannian Hessian</td>
  <td><nobr><code>M.ehess2rhess(Y, egrad, ehess, U)</code></nobr> </td>
<td>$\operatorname{Hess} f(Y)[U] = P_Y(\nabla^2 f(Y)[U])$, where <code>egrad</code> represents the Euclidean gradient $\nabla f(Y)$ (which happens to not be necessary in this case) and <code>ehess</code> represents the Euclidean Hessian $\nabla^2 f(Y)[U]$, both being vectors in the ambient space.</td>
</tr>
<tr>
  <td>Retraction </td>
<td><code>M.retr(Y, U, t) </code></td>
<td>$\operatorname{Retr}_Y(tU) = Y + tU$ </td>
</tr>
<tr>
  <td>Random point </td>
<td><code>M.rand() </code></td>
<td>Returns a point at random as follows: generate $Y$ with i.i.d. normal entries; return $Y$. With high probability, $Y$ will indeed be full-rank. </td>
</tr>
<tr>
  <td>Random vector </td>
<td><code>M.randvec(Y) </code></td>
<td>Returns a horizontal vector at $Y$ with uniformly random direction, obtained as follows: generate $H$ with i.i.d. normal entries; return $P_Y(H)/\|P_Y(H)\|_Y$. </td>
</tr>
<tr>
  <td>Vector transport </td>
<td><code>M.transp(Y, Z, U) </code></td>
<td>$\operatorname{Transp}_{Z\leftarrow Y}(U) = P_Z(U)$, where $U$ is a horizontal vector at $Y$ that is transported to the horizontal space at $Z$. </td>
</tr>
</tbody>
</table>
<p></p>
</section>
<section id="differentials">
  <div class="page-header">
    <h1>Example</h1>
  </div>
  <p>This is an example of low-rank matrix approximation. Let $A\in\mathbb{R}^{n\times n}$ be a symmetric matrix. We minimize the following cost function:</p>
  <p>$$\phi(X) =\| X - A \|_F ^2,$$</p>
  <p>such that $X \in S_+(n, k)$. $X$ is factorized as $YY^T$ with $Y \in \mathbb{R}^{n \times k}_*$. The function $f:\mathbb{R}^{n \times k}_* \rightarrow \mathbb{R}$ is defined as $f(Y) = \| YY^T - A \|_F ^2 $. Compute the Euclidean gradient and Hessian of $f$:</p>
  <p>$$\nabla f(Y) = 4(YY^T - A)Y,$$</p>
  <p>$$\nabla^2 f(Y)[U] = 4(YU^T + UY^T)Y + 4(YY^T - A)U.$$</p>
  <p>The Riemannian gradient and Hessian are obtained by applying the <code>M.egrad2rgrad</code> and <code>M.ehess2rhess</code> operators:</p>
  <p>$$\operatorname{grad} f(x) = 4(YY^T - A)Y,$$</p>
  <p>$$\operatorname{Hess} f(Y)[U] = \nabla^2 f(Y)[U] - Y\Omega$$ where $\Omega$ is obtained by solving the <a
      href="http://en.wikipedia.org/wiki/Sylvester_equation">Sylvester equation</a>, $$ \Omega (Y^T Y) + (Y^T Y )\Omega = Y^T \nabla^2 f(Y)[U] - \nabla^2 f(Y)[U] ^T Y. $$ </p>
  <p> The Sylvester equation can be solved efficiently using <code>lyap</code> of MATLAB. Notice that there is no need to compute these explicitly: it suffices to write code for the Euclidean quantities and to apply the conversion tools on them to obtain the Riemannian quantities, as in the following code:</p>
  <pre class="prettyprint lang-matlab linenums">% Generate the problem data. 
n = 1000; 
k = 5;
Y_org = randn(n,k);
A = Y_org*Y_org'; 

% Create the problem structure.
manifold = symfixedrankYYfactory(n,k);
problem.M = manifold;

% Define the problem cost function and its gradient.<br>
problem.cost = @(Y) norm( Y*Y' - A, 'fro')^2;<br>egrad = @(Y) 4*(Y*Y' - A)*Y;<br>ehess = @(Y, U) 4*(Y*U' + U*Y')*Y + 4*(Y*Y' - A)*U;
problem.grad = @(Y) manifold.egrad2rgrad(Y, egrad(Y));<br>problem.hess = @(Y, U) manifold.ehess2rhess(Y, egrad(Y), ehess(Y, U), U);<br><br>% Numerically check the differentials.<br>checkgradient(problem); pause;<br>checkhessian(problem); pause;<br><br>% Execute the optimization<br>Y = trustregions(problem);</pre>
</section>
<section id="references">
  <div class="page-header">
    <h1>References</h1>
  </div>
  [JBAS10] M. Journ&#233;e, F. Bach, P.-A. Absil and R. Sepulchre, <a href="http://epubs.siam.org/doi/abs/10.1137/080731359">Low-rank optimization on the cone of positive semidefinite matrices</a>, SIOPT, 2010.<br>
  [AMS08] P.-A. Absil, R. Mahony and R. Sepulchre, <a target="_blank" href="https://press.princeton.edu/absil">Optimization Algorithms on Matrix Manifolds</a>, Princeton University Press, 2008. </section>
<section id="examples">
  <div class="page-header">
    <h1>List of examples</h1>
  </div>
  <p>We are still working on building a collection of examples for Manopt. The relevant ones will be referenced here when the time comes.</p>
</section>
</div>
</div>
</div>
<!-- /container -->
<!-- Le javascript ================================================== -->
<script type="text/javascript" src="bootstrap/js/jquery.min.js">
	</script>
<script type="text/javascript" src="bootstrap/js/bootstrap.js">
	</script>
<script type="text/javascript" src="bootstrap/js/prettify.js">
	</script>
<script type="text/javascript" src="bootstrap/js/lang-matlab.js">
	</script>
<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script> <script type="text/javascript">

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-37402854-1']);
_gaq.push(['_trackPageview']);

(function() {
 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 })();
</script>
</body>
</html>
